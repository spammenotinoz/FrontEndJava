import{d as v,a2 as h,$ as y,r as _,j as b,Q as R,R as U,X as n,V as t,a3 as $,c as k,Y as C}from"./vue-ed5b065f.js";import{u as E,m as S}from"./index-0ad4123e.js";import{b as V,e as q,h as K,g as j}from"./naive_ui-22e043f0.js";const B={class:"flex justify-center items-center mt-20"},D=v({__name:"index",setup(I){const r=h(),{t:p}=y(),l=E(),c=_(),o=b({username:"",password:""}),u=_(!1),f={username:{required:!0,message:p("tips.pleaseEnterUsername"),trigger:"blur"},password:{required:!0,message:p("tips.pleaseEnterPassword"),trigger:"blur"}},d=async()=>{var s;u.value||(s=c.value)==null||s.validate(e=>{e||(u.value=!0)}).then(async()=>{var e;try{await l.login(o);const{redirect:a}=r.currentRoute.value.query;if(await l.fetchUserInfo(),S.success(p("tips.loginSuccess")),a){await r.push(a);return}await r.push({name:(e=l.user)!=null&&e.is_superuser?"admin":"conversation"})}catch(a){console.log(a)}finally{u.value=!1}})};return l.user&&r.push({name:"conversation"}),(s,e)=>{const a=V,i=q,g=K,w=j;return R(),U("div",B,[n(w,{ref_key:"formRef",ref:c,model:o,rules:f,"label-col":{span:8},"wrapper-col":{span:16}},{default:t(()=>[n(i,{label:s.$t("commons.username"),path:"username"},{default:t(()=>[n(a,{value:o.username,"onUpdate:value":e[0]||(e[0]=m=>o.username=m),placeholder:s.$t("tips.pleaseEnterUsername"),"input-props":{autoComplete:"username"}},null,8,["value","placeholder"])]),_:1},8,["label"]),n(i,{label:s.$t("commons.password"),path:"password"},{default:t(()=>[n(a,{value:o.password,"onUpdate:value":e[1]||(e[1]=m=>o.password=m),type:"password","show-password-on":"click",placeholder:s.$t("tips.pleaseEnterPassword"),"input-props":{autoComplete:"current-password"},onKeyup:$(d,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["label"]),n(i,{"wrapper-col":"{ span: 16, offset: 8 }"},{default:t(()=>[n(g,{type:"primary",enabled:u.value,onClick:d},{default:t(()=>[k(C(s.$t("commons.login")),1)]),_:1},8,["enabled"])]),_:1})]),_:1},8,["model"])])}}});export{D as default};
//# sourceMappingURL=index-93d39f6c.js.map
